{"ast":null,"code":"var _jsxFileName = \"/Users/trungtran/Documents/GitHub/portfolio/src/pages/product/index.tsx\",\n  _s = $RefreshSig$();\nimport { TextField } from \"@mui/material\";\nimport React, { useState } from \"react\";\nimport InfiniteScroll from \"react-infinite-scroll-component\";\nimport ProductItem from \"../../components/product/ProductItem\";\nimport { useProduct, useSearchProduct } from \"../../hook/useProduct\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ProductPage() {\n  _s();\n  var _data$data$products, _data$data, _searchList$data$prod, _searchList$data;\n  const [params, setParams] = useState();\n  const [searchParams, setSearchParams] = useState();\n  const [searchValue, setSearchValue] = useState(\"\");\n  const [timeoutName, setTimeoutName] = useState();\n  const [hasNext, setHasNext] = useState(true);\n  const {\n    data\n  } = useProduct({\n    params\n  });\n  const {\n    data: searchList\n  } = useSearchProduct({\n    params: searchParams\n  });\n  const products = searchValue === \"\" ? (_data$data$products = data === null || data === void 0 ? void 0 : (_data$data = data.data) === null || _data$data === void 0 ? void 0 : _data$data.products) !== null && _data$data$products !== void 0 ? _data$data$products : [] : (_searchList$data$prod = searchList === null || searchList === void 0 ? void 0 : (_searchList$data = searchList.data) === null || _searchList$data === void 0 ? void 0 : _searchList$data.products) !== null && _searchList$data$prod !== void 0 ? _searchList$data$prod : [];\n  const fetchData = () => {\n    searchValue != \"\" ? fetchSearchParams() : fetchParams();\n  };\n  function fetchParams() {\n    var _params$limit, _data$data$total, _data$data2;\n    const limit = ((_params$limit = params === null || params === void 0 ? void 0 : params.limit) !== null && _params$limit !== void 0 ? _params$limit : 30) + 20;\n    const maxLimit = (_data$data$total = data === null || data === void 0 ? void 0 : (_data$data2 = data.data) === null || _data$data2 === void 0 ? void 0 : _data$data2.total) !== null && _data$data$total !== void 0 ? _data$data$total : limit;\n    setParams({\n      limit: Math.min(maxLimit, limit)\n    });\n    if ((products === null || products === void 0 ? void 0 : products.length) == maxLimit) {\n      setHasNext(false);\n    }\n  }\n  function fetchSearchParams() {\n    var _searchList$data$tota, _searchList$data2;\n    const limit = (searchParams === null || searchParams === void 0 ? void 0 : searchParams.limit) + 4;\n    const maxLimit = (_searchList$data$tota = searchList === null || searchList === void 0 ? void 0 : (_searchList$data2 = searchList.data) === null || _searchList$data2 === void 0 ? void 0 : _searchList$data2.total) !== null && _searchList$data$tota !== void 0 ? _searchList$data$tota : limit;\n    setSearchParams({\n      limit: Math.min(maxLimit, limit),\n      q: searchValue\n    });\n    if (Math.min(maxLimit, limit) == maxLimit) {\n      setHasNext(false);\n    }\n  }\n  function handleSearchValue(searchString) {\n    setHasNext(true);\n    setSearchParams({\n      limit: 4,\n      q: searchString\n    });\n  }\n  const handleFilterValue = filterValue => {\n    setSearchValue(filterValue);\n    if (timeoutName) {\n      clearTimeout(timeoutName);\n    }\n    const newTimeoutname = setTimeout(() => {\n      handleSearchValue(filterValue);\n    }, 300);\n    setTimeoutName(newTimeoutname);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Product List\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(TextField, {\n      id: \"outlined-basic\",\n      label: \"Search Product\",\n      variant: \"outlined\",\n      placeholder: \"Search products...\",\n      value: searchValue,\n      onChange: e => handleFilterValue(e.target.value)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(InfiniteScroll, {\n        dataLength: (products === null || products === void 0 ? void 0 : products.length) || 0,\n        next: fetchData,\n        hasMore: hasNext,\n        scrollThreshold: 1,\n        loader: /*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"Loading...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 19\n        }, this),\n        endMessage: /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            textAlign: \"center\"\n          },\n          children: /*#__PURE__*/_jsxDEV(\"b\", {\n            children: \"Yay! You have seen it all\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 13\n        }, this),\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: products === null || products === void 0 ? void 0 : products.map(product => /*#__PURE__*/_jsxDEV(ProductItem, {\n            product: product\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 5\n  }, this);\n}\n_s(ProductPage, \"3npDlPHKII3NFBYYrO8wlWm0/W4=\", false, function () {\n  return [useProduct, useSearchProduct];\n});\n_c = ProductPage;\nvar _c;\n$RefreshReg$(_c, \"ProductPage\");","map":{"version":3,"names":["TextField","React","useState","InfiniteScroll","ProductItem","useProduct","useSearchProduct","jsxDEV","_jsxDEV","ProductPage","_s","_data$data$products","_data$data","_searchList$data$prod","_searchList$data","params","setParams","searchParams","setSearchParams","searchValue","setSearchValue","timeoutName","setTimeoutName","hasNext","setHasNext","data","searchList","products","fetchData","fetchSearchParams","fetchParams","_params$limit","_data$data$total","_data$data2","limit","maxLimit","total","Math","min","length","_searchList$data$tota","_searchList$data2","q","handleSearchValue","searchString","handleFilterValue","filterValue","clearTimeout","newTimeoutname","setTimeout","children","fileName","_jsxFileName","lineNumber","columnNumber","id","label","variant","placeholder","value","onChange","e","target","dataLength","next","hasMore","scrollThreshold","loader","endMessage","style","textAlign","map","product","_c","$RefreshReg$"],"sources":["/Users/trungtran/Documents/GitHub/portfolio/src/pages/product/index.tsx"],"sourcesContent":["import { TextField } from \"@mui/material\";\nimport React, { useState } from \"react\";\nimport InfiniteScroll from \"react-infinite-scroll-component\";\nimport ProductItem from \"../../components/product/ProductItem\";\nimport { useProduct, useSearchProduct } from \"../../hook/useProduct\";\nimport { Params } from \"../../types/base\";\n\nexport default function ProductPage() {\n  const [params, setParams] = useState<Partial<Params>>();\n  const [searchParams, setSearchParams] = useState<Partial<Params>>();\n  const [searchValue, setSearchValue] = useState(\"\");\n  const [timeoutName, setTimeoutName] = useState<any>();\n  const [hasNext, setHasNext] = useState(true);\n  const { data } = useProduct({\n    params,\n  });\n  const { data: searchList } = useSearchProduct({\n    params: searchParams,\n  });\n  const products =\n    searchValue === \"\"\n      ? data?.data?.products ?? []\n      : searchList?.data?.products ?? [];\n\n  const fetchData = () => {\n    searchValue != \"\" ? fetchSearchParams() : fetchParams();\n  };\n\n  function fetchParams() {\n    const limit = (params?.limit ?? 30) + 20;\n    const maxLimit = data?.data?.total ?? limit;\n    setParams({ limit: Math.min(maxLimit, limit) });\n    if (products?.length == maxLimit) {\n      setHasNext(false);\n    }\n  }\n\n  function fetchSearchParams() {\n    const limit = searchParams?.limit! + 4;\n    const maxLimit = searchList?.data?.total ?? limit;\n    setSearchParams({ limit: Math.min(maxLimit, limit), q: searchValue });\n    if (Math.min(maxLimit, limit) == maxLimit) {\n      setHasNext(false);\n    }\n  }\n\n  function handleSearchValue(searchString: string) {\n    setHasNext(true);\n    setSearchParams({ limit: 4, q: searchString });\n  }\n\n  const handleFilterValue = (filterValue: string) => {\n    setSearchValue(filterValue);\n    if (timeoutName) {\n      clearTimeout(timeoutName);\n    }\n\n    const newTimeoutname = setTimeout(() => {\n      handleSearchValue(filterValue);\n    }, 300);\n\n    setTimeoutName(newTimeoutname);\n  };\n\n  return (\n    <div>\n      <h1>Product List</h1>\n      <TextField\n        id=\"outlined-basic\"\n        label=\"Search Product\"\n        variant=\"outlined\"\n        placeholder=\"Search products...\"\n        value={searchValue}\n        onChange={(e) => handleFilterValue(e.target.value)}\n      />\n      <div>\n        <InfiniteScroll\n          dataLength={products?.length || 0}\n          next={fetchData}\n          hasMore={hasNext}\n          scrollThreshold={1}\n          loader={<h4>Loading...</h4>}\n          endMessage={\n            <p style={{ textAlign: \"center\" }}>\n              <b>Yay! You have seen it all</b>\n            </p>\n          }\n        >\n          <div>\n            {products?.map((product) => (\n              <ProductItem product={product} />\n            ))}\n          </div>\n        </InfiniteScroll>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}